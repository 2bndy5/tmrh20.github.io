<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9"/>
<title>Newly Optimized RF24Network Layer: Network Layer for RF24 Radios</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Newly Optimized RF24Network Layer
   </div>
   <div id="projectbrief">2014-2015 - Optimized RF24 Network Layer for NRF24L01 radios</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Network Layer for RF24 Radios </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This class implements an <a href="http://en.wikipedia.org/wiki/Network_layer">OSI Network Layer</a> using nRF24L01(+) radios driven by the newly optimized <a href="http://tmrh20.github.com/RF24/">RF24</a> library fork.</p>
<h1><a class="anchor" id="Purpose"></a>
Purpose/Goal</h1>
<p>Original: Create an alternative to ZigBee radios for Arduino communication.</p>
<p>New: Enhance the current functionality for maximum efficiency, reliability, and speed</p>
<p>Xbees are excellent little radios, backed up by a mature and robust standard protocol stack. They are also expensive.</p>
<p>For many Arduino uses, they seem like overkill. So I am working to improve the current standard for nRF24L01 radios. The best RF24 modules are available for less than $6 from many sources. With the <a class="el" href="classRF24Network.html" title="2014-2015 - Optimized Network Layer for RF24 Radios ">RF24Network</a> layer, I hope to cover many common communication scenarios.</p>
<p>Please see the <a class="el" href="Zigbee.html">Comparison to ZigBee</a> page for a comparison against the ZigBee protocols</p>
<h1><a class="anchor" id="Features"></a>
Features</h1>
<p><b>Whats new? </b><br />
 </p><ul>
<li>New: (Dec 8) Merge of RPi and Arduino code. Finally moving closer to a stable release. Report issues at <a href="https://github.com/TMRh20/RF24Network/issues">https://github.com/TMRh20/RF24Network/issues</a> </li>
<li>New functionality: (Dec 8) Support for fragmented multicast payloads on both RPi and Arduino </li>
<li>New functionality: (Nov 24) Fragmentation &amp; reassembly supported on both RPi and Arduino </li>
<li>Note: structure of network frames is changed, these are only used by external applications like RF24Ethernet and RF24toTUN, and for fragmentation </li>
<li>New functionality: User message types 1 through 64 will not receive a network ack</li>
</ul>
<p>The layer provides: </p><ul>
<li><b>New</b> (2014): Network ACKs: Efficient acknowledgement of network-wide transmissions, via dynamic radio acks and network protocol acks. </li>
<li><b>New</b> (2014): Updated addressing standard for optimal radio transmission. </li>
<li><b>New</b> (2014): Extended timeouts and staggered timeout intervals. The new txTimeout variable allows fully automated extended timeout periods via auto-retry/auto-reUse of payloads. </li>
<li><b>New</b> (2014): Optimization to the core library provides improvements to reliability, speed and efficiency. See <a href="https://tmrh20.github.io/RF24">https://tmrh20.github.io/RF24</a> for more info. </li>
<li><b>New</b> (2014): Built in sleep mode using interrupts. (Still under development. (Enable via <a class="el" href="RF24Network__config_8h_source.html">RF24Network_config.h</a>)) </li>
<li><b>New</b> (2014): Dual headed operation: The use of dual radios for busy routing nodes or the master node enhances throughput and decreases errors. See the <a href="Tuning.html">Tuning</a> section. </li>
<li>Host Addressing. Each node has a logical address on the local network. </li>
<li>Message Forwarding. Messages can be sent from one node to any other, and this layer will get them there no matter how many hops it takes. </li>
<li>Ad-hoc Joining. A node can join a network without any changes to any existing nodes.</li>
</ul>
<p>The layer does not provide: </p><ul>
<li>Dynamic address assignment. (See RF24Mesh) </li>
<li>Layer 4 protocols (TCP/IP - See RF24Ethernet and RF24toTUN)</li>
</ul>
<h1><a class="anchor" id="More"></a>
How to learn more</h1>
<ul>
<li><a href="classRF24Network.html">RF24Network Class Documentation</a> </li>
<li><a href="AdvancedConfig.html">Advanced Configuration Options</a> </li>
<li><a href="Addressing.html">Addressing format</a> </li>
<li><a href="Tuning.html">Topology and Overview</a> </li>
<li><a href="https://github.com/TMRh20/RF24Network/archive/Development.zip">Download Current Development Package</a> </li>
<li><a href="examples.html">Examples Page</a>. Start with <a href="helloworld_rx_8ino-example.html">helloworld_rx</a> and <a href="helloworld_tx_8ino-example.html">helloworld_tx</a>.</li>
</ul>
<p><b> Additional Information &amp; Add-ons </b> </p><ul>
<li><a href="https://github.com/TMRh20/RF24Mesh">RF24Mesh: Dynamic Mesh Layer for RF24Network Dev</a> </li>
<li><a href="https://github.com/TMRh20/RF24Ethernet">RF24Ethernet: TCP/IP over RF24Network</a> </li>
<li><a href="http://tmrh20.blogspot.com/2014/03/high-speed-data-transfers-and-wireless.html">My Blog: RF24 Optimization Overview</a> </li>
<li><a href="http://tmrh20.blogspot.com/2014/03/arduino-radiointercomwireless-audio.html">My Blog: RF24 Wireless Audio</a> </li>
<li><a href="http://maniacbug.github.com/RF24/">RF24: Original Author</a> </li>
</ul>
<h1><a class="anchor" id="Topology"></a>
Topology for Mesh Networks using nRF24L01(+)</h1>
<p>This network layer takes advantage of the fundamental capability of the nRF24L01(+) radio to listen actively to up to 6 other radios at once. The network is arranged in a <a href="http://en.wikipedia.org/wiki/Network_Topology#Tree">Tree Topology</a>, where one node is the base, and all other nodes are children either of that node, or of another. Unlike a true mesh network, multiple nodes are not connected together, so there is only one path to any given node.</p>
<h1><a class="anchor" id="Octal"></a>
Octal Addressing and Topology</h1>
<p>Each node must be assigned an 15-bit address by the administrator. This address exactly describes the position of the node within the tree. The address is an octal number. Each digit in the address represents a position in the tree further from the base.</p>
<ul>
<li>Node 00 is the base node. </li>
<li>Nodes 01-05 are nodes whose parent is the base. </li>
<li>Node 021 is the second child of node 01. </li>
<li>Node 0321 is the third child of node 021, an so on. </li>
<li>The largest node address is 05555, so 3,125 nodes are allowed on a single channel. An example topology is shown below, with 5 nodes in direct communication with the master node, and multiple leaf nodes spread out at a distance, using intermediate nodes to reach other nodes.</li>
</ul>
<table class="doxtable">
<tr>
<th></th><th></th><th>00 </th><th></th><th></th><th>00 </th><th></th><th></th><th></th><th>Master Node (00)  </th></tr>
<tr>
<td></td><td></td><td>01 </td><td></td><td></td><td>04 </td><td></td><td></td><td></td><td>1st level children of master (00) </td></tr>
<tr>
<td></td><td>011</td><td></td><td>021</td><td></td><td></td><td>014 </td><td></td><td></td><td>2nd level children of master. Children of 1st level. </td></tr>
<tr>
<td>111</td><td></td><td></td><td>121</td><td>221</td><td></td><td></td><td>114</td><td></td><td>3rd level children of master. Children of 2nd level. </td></tr>
<tr>
<td></td><td></td><td></td><td></td><td>1221</td><td></td><td>1114</td><td>2114</td><td>3114</td><td>4th level children of master. Children of 3rd level. </td></tr>
</table>
<h1><a class="anchor" id="Routing"></a>
How routing is handled</h1>
<p>When sending a message using <a class="el" href="classRF24Network.html#ac8e9571bb3d2c20d00955b8f5c15b541" title="Send a message. ">RF24Network::write()</a>, you fill in the header with the logical node address. The network layer figures out the right path to find that node, and sends it through the system until it gets to the right place. This works even if the two nodes are far separated, as it will send the message down to the base node, and then back out to the final destination.</p>
<p>All of this work is handled by the <a class="el" href="classRF24Network.html#ad59983f89b09d17d7d9b0581f658a41c" title="Main layer loop. ">RF24Network::update()</a> method, so be sure to call it regularly or your network will miss packets.</p>
<h1><a class="anchor" id="Startup"></a>
Starting up a node</h1>
<p>When a node starts up, it only has to contact its parent to establish communication. No direct connection to the Base node is needed. This is useful in situations where relay nodes are being used to bridge the distance to the base, so leaf nodes are out of range of the base.</p>
<h1><a class="anchor" id="Directionality"></a>
Directionality</h1>
<p>By default all nodes are always listening, so messages will quickly reach their destination.</p>
<p>You may choose to sleep any nodes on the network if using interrupts. This is useful in a case where the nodes are operating on batteries and need to sleep. This greatly decreases the power requirements for a sensor network. The leaf nodes can sleep most of the time, and wake every few minutes to send in a reading. Routing nodes can be triggered to wake up whenever a payload is received See sleepNode() in the class documentation, and RFNetwork_config.h to enable sleep mode. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Jun 20 2015 04:16:20 for Newly Optimized RF24Network Layer by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9
</small></address>
</body>
</html>
